<!-- Loading State -->
<div *ngIf="loading" class="loading-container">
  <div class="loading-content">
    <mat-icon class="loading-icon">refresh</mat-icon>
    <p>Betöltés...</p>
  </div>
</div>

<!-- Content Container -->
<div *ngIf="!loading" class="quiz-list-container" [class.grid-view]="viewMode === 'grid'" [class.list-view]="viewMode === 'list'">
  
  <!-- Folders Section -->
  <section *ngIf="folders.length > 0" class="folders-section">
    <h3 class="section-title">
      <mat-icon>folder</mat-icon>
      Mappák
    </h3>
    
    <div class="items-grid">
      <div 
        *ngFor="let folder of folders; trackBy: trackByFolderId" 
        class="folder-card item-card"
        (click)="onFolderSelect(folder)">
        
        <div class="card-header">
          <div class="card-icon folder-icon">
            <mat-icon>folder</mat-icon>
          </div>
          
          <div class="card-actions">
            <button 
              mat-icon-button
              [matMenuTriggerFor]="folderMenu"
              (click)="$event.stopPropagation()"
              class="action-btn">
              <mat-icon>more_vert</mat-icon>
            </button>
            
            <mat-menu #folderMenu="matMenu">
              <button mat-menu-item (click)="onFolderEdit(folder)">
                <mat-icon>edit</mat-icon>
                <span>Szerkesztés</span>
              </button>
              <button mat-menu-item (click)="onFolderDelete(folder)" class="danger-action">
                <mat-icon>delete</mat-icon>
                <span>Törlés</span>
              </button>
            </mat-menu>
          </div>
        </div>
        
        <div class="card-content">
          <h4 class="card-title">{{ folder.name }}</h4>
          <p class="card-description" *ngIf="folder.description">{{ folder.description }}</p>
          
          <div class="folder-stats">
            <div class="stat-item">
              <mat-icon>quiz</mat-icon>
              <span>{{ folder.quizzes?.length || 0 }} kvíz</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Quizzes Section -->
  <section *ngIf="quizzes.length > 0" class="quizzes-section">
    <h3 class="section-title">
      <mat-icon>quiz</mat-icon>
      Kvízek
    </h3>
    
    <div class="items-grid">
      <div 
        *ngFor="let quiz of quizzes; trackBy: trackByQuizId" 
        class="quiz-card item-card"
        [style.border-left-color]="quiz.color"
        (click)="onQuizSelect(quiz)">
        
        <div class="card-header">
          <div class="card-icon quiz-icon" [style.background-color]="quiz.color">
            <mat-icon>quiz</mat-icon>
          </div>
          
          <div class="card-actions">
            <button 
              mat-icon-button
              [matMenuTriggerFor]="quizMenu"
              (click)="$event.stopPropagation()"
              class="action-btn">
              <mat-icon>more_vert</mat-icon>
            </button>
            
            <mat-menu #quizMenu="matMenu">
              <button mat-menu-item (click)="onQuizSelect(quiz)">
                <mat-icon>play_arrow</mat-icon>
                <span>Tanulás</span>
              </button>
              <button mat-menu-item (click)="onQuizEdit(quiz)">
                <mat-icon>edit</mat-icon>
                <span>Szerkesztés</span>
              </button>
              <button mat-menu-item (click)="onQuizExport(quiz)">
                <mat-icon>download</mat-icon>
                <span>Exportálás</span>
              </button>
              <button mat-menu-item (click)="onQuizDelete(quiz)" class="danger-action">
                <mat-icon>delete</mat-icon>
                <span>Törlés</span>
              </button>
            </mat-menu>
          </div>
        </div>
        
        <div class="card-content">
          <h4 class="card-title">{{ quiz.name }}</h4>
          <p class="card-description" *ngIf="quiz.description">{{ quiz.description }}</p>
          
          <!-- Quiz Stats -->
          <div class="quiz-stats">
            <div class="stat-item">
              <mat-icon>style</mat-icon>
              <span>{{ quiz.cards?.length || 0 }} kártya</span>
            </div>
            
            <div class="stat-item">
              <mat-icon>schedule</mat-icon>
              <span>{{ quiz.estimated_time }} perc</span>
            </div>
            
            <div class="stat-item difficulty" [style.color]="getDifficultyColor(quiz.difficulty_level)">
              <mat-icon>bar_chart</mat-icon>
              <span>{{ getDifficultyLabel(quiz.difficulty_level) }}</span>
            </div>
          </div>
          
          <!-- Tags -->
          <div class="quiz-tags" *ngIf="quiz.tags && quiz.tags.length > 0">
            <mat-chip-set>
              <mat-chip *ngFor="let tag of quiz.tags.slice(0, 3)">
                {{ tag }}
              </mat-chip>
              <mat-chip *ngIf="quiz.tags.length > 3" class="more-tags">
                +{{ quiz.tags.length - 3 }}
              </mat-chip>
            </mat-chip-set>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Empty State -->
  <div *ngIf="quizzes.length === 0 && folders.length === 0" class="empty-state">
    <div class="empty-content">
      <mat-icon class="empty-icon">quiz</mat-icon>
      <h3>Nincsenek kvízek</h3>
      <p>Hozz létre az első kvízedet a kezdéshez!</p>
    </div>
  </div>
</div>
